---
layout: layout.njk
title: ä¾èµ–è§£æž
eleventyNavigation:
  key: features-dependency-resolution
  title: ðŸ“” ä¾èµ–è§£æž
  order: 3
---

å½“ Parcel æž„å»ºæ‚¨çš„æºä»£ç æ—¶ï¼Œå®ƒä¼šå‘çŽ°**ä¾èµ–é¡¹**ï¼Œè¿™å…è®¸å°†ä»£ç åˆ†è§£ä¸ºå•ç‹¬çš„æ–‡ä»¶å¹¶åœ¨å¤šä¸ªåœ°æ–¹é‡ç”¨ã€‚ä¾èµ–é¡¹æè¿°äº†åœ¨å“ªé‡Œå¯ä»¥æ‰¾åˆ°åŒ…å«æ‚¨æ‰€ä¾èµ–çš„ä»£ç çš„æ–‡ä»¶ï¼Œä»¥åŠæœ‰å…³å¦‚ä½•æž„å»ºå®ƒçš„å…ƒæ•°æ®ã€‚

## ä¾èµ–è¯´æ˜Žç¬¦

ä¾èµ–é¡¹è¯´æ˜Žç¬¦æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œå®ƒæè¿°äº†ä¾èµ–é¡¹ç›¸å¯¹äºŽå¯¼å…¥å®ƒçš„æ–‡ä»¶çš„ä½ç½®ã€‚ä¾‹å¦‚ï¼Œåœ¨ JavaScript ä¸­ï¼Œ`import`è¯­å¥æˆ–`require`å‡½æ•°å¯ç”¨äºŽåˆ›å»ºä¾èµ–å…³ç³»ã€‚åœ¨ CSS ä¸­ï¼Œ`@import`å’Œ`url()`å¯ä»¥ä½¿ç”¨ã€‚é€šå¸¸ï¼Œè¿™äº›ä¾èµ–é¡¹ä¸æŒ‡å®šå®Œæ•´çš„ç»å¯¹è·¯å¾„ï¼Œè€Œæ˜¯æŒ‡å®šä¸€ä¸ªè¾ƒçŸ­çš„è¯´æ˜Žç¬¦ï¼Œç”± Parcel å’Œå…¶ä»–å·¥å…·è§£æžä¸ºç»å¯¹è·¯å¾„ã€‚

Parcel å®žçŽ°äº† [Node module resolution algorithm](https://nodejs.org/api/modules.html#modules_all_together)çš„å¢žå¼ºç‰ˆæœ¬ã€‚å®ƒè´Ÿè´£å°†ä¾èµ–è¯´æ˜Žç¬¦è½¬æ¢ä¸ºå¯ä»¥ä»Žæ–‡ä»¶ç³»ç»ŸåŠ è½½çš„ç»å¯¹è·¯å¾„ã€‚é™¤äº†è®¸å¤šå·¥å…·æ”¯æŒçš„æ ‡å‡†ä¾èµ–è¯´æ˜Žç¬¦å¤–ï¼ŒParcel è¿˜æ”¯æŒä¸€äº›é™„åŠ è¯´æ˜Žç¬¦ç±»åž‹å’ŒåŠŸèƒ½ã€‚

### ç›¸å¯¹è¯´æ˜Žç¬¦

ç›¸å¯¹è¯´æ˜Žç¬¦ä»¥`.`æˆ–`..`å¼€å¤´ï¼Œå¹¶è§£æžç›¸å¯¹äºŽå¯¼å…¥æ–‡ä»¶çš„æ–‡ä»¶ã€‚

{% sample %}
{% samplefile "/path/to/project/src/client.js" %}

```javascript
import "./utils.js";
import "../constants.js";
```

{% endsamplefile %}
{% endsample %}

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œç¬¬ä¸€ä¸ªå¯¼å…¥å°†è§£æžä¸º `/path/to/project/src/utils.js`ï¼Œç¬¬äºŒä¸ªå°†è§£æžä¸º `/path/to/project/constants.js`ã€‚

#### æ–‡ä»¶æ‰©å±•å

å»ºè®®åœ¨æ‰€æœ‰å¯¼å…¥è¯´æ˜Žç¬¦ä¸­åŒ…å«å®Œæ•´çš„æ–‡ä»¶æ‰©å±•åã€‚è¿™æ—¢æé«˜äº†ä¾èµ–æ€§è§£æžæ€§èƒ½ï¼Œåˆå‡å°‘äº†æ­§ä¹‰ã€‚

ä¹Ÿå°±æ˜¯è¯´ï¼Œä¸ºäº†ä¸Ž Node ä¸­çš„ CommonJS å’Œ TypeScript å…¼å®¹ï¼ŒParcel å…è®¸ä¸ºæŸäº›æ–‡ä»¶ç±»åž‹çœç•¥æ–‡ä»¶æ‰©å±•åã€‚å¯ä»¥çœç•¥çš„æ–‡ä»¶æ‰©å±•ååŒ…æ‹¬ `.ts`, `.tsx`, `.js`, `.jsx`, å’Œ `.json`ã€‚å¯¼å…¥æ‰€æœ‰å…¶ä»–æ–‡ä»¶ç±»åž‹éœ€è¦æ–‡ä»¶æ‰©å±•åã€‚

ä»¥ä¸‹ç¤ºä¾‹è§£æžä¸ºä¸Žä¸Šè¿°ç›¸åŒçš„æ–‡ä»¶ã€‚

{% sample %}
{% samplefile "/path/to/project/src/client.js" %}

```javascript
import "./utils";
import "../constants";
```

{% endsamplefile %}
{% endsample %}

è¯·æ³¨æ„ï¼Œåªæœ‰åœ¨ä»Ž JavaScript æˆ– TypeScript æ–‡ä»¶å¯¼å…¥æ—¶ï¼Œæ‰èƒ½çœç•¥è¿™äº›ã€‚åœ¨ HTML å’Œ CSS ç­‰å…¶ä»–æ–‡ä»¶ç±»åž‹ä¸­å®šä¹‰çš„ä¾èµ–é¡¹å§‹ç»ˆéœ€è¦æ–‡ä»¶æ‰©å±•åã€‚

#### ç›®å½•ç´¢å¼•æ–‡ä»¶

åœ¨ JavaScriptã€Typescript å’Œå…¶ä»–åŸºäºŽ JS çš„è¯­è¨€ä¸­ï¼Œä¾èµ–è¯´æ˜Žç¬¦å¯èƒ½ä¼šè§£æžä¸ºç›®å½•è€Œä¸æ˜¯æ–‡ä»¶ã€‚å¦‚æžœç›®å½•åŒ…å«ä¸€ä¸ª`package.json`æ–‡ä»¶ï¼Œä¸»æ¡ç›®å°†æŒ‰ç…§[Package entries](#package-entries)éƒ¨åˆ†ä¸­çš„è¯´æ˜Žè¿›è¡Œè§£æžã€‚å¦‚æžœ`package.json`ä¸å­˜åœ¨, å®ƒå°†å°è¯•è§£æžåˆ°ç›®å½•ä¸­çš„ç´¢å¼•æ–‡ä»¶ï¼Œä¾‹å¦‚`index.js` æˆ–`index.ts`ã€‚ç´¢å¼•æ–‡ä»¶æ”¯æŒä¸Šé¢åˆ—å‡ºçš„æ‰€æœ‰æ‰©å±•åã€‚

{% sample %}
{% samplefile "/path/to/project/src/app.js" %}

```javascript
import "./client";
```

{% endsamplefile %}
{% endsample %}

ä¾‹å¦‚ï¼Œå¦‚æžœ`/path/to/project/src/client`æ˜¯ç›®å½•ï¼Œåˆ™ä¸Šè¿°è¯´æ˜Žç¬¦å¯ä»¥è§£æžä¸º`/path/to/project/src/client/index.js`ã€‚

### è£¸è¯´æ˜Žç¬¦

è£¸è¯´æ˜Žç¬¦ä»¥é™¤`.`, `/`, or `~`ä¹‹å¤–çš„ä»»ä½•å­—ç¬¦å¼€å¤´ã€‚ åœ¨ JavaScriptã€TypeScript å’Œå…¶ä»–åŸºäºŽ JS çš„è¯­è¨€ä¸­ï¼Œå®ƒä»¬è§£æžä¸º`node_modules`ã€‚å¯¹äºŽå…¶ä»–ç±»åž‹çš„æ–‡ä»¶ï¼Œä¾‹å¦‚ HTML å’Œ CSSï¼Œè£¸è¯´æ˜Žç¬¦çš„å¤„ç†æ–¹å¼ä¸Ž[relative specifiers](#relative-specifiers)ç›¸åŒã€‚

{% sample %}
{% samplefile "/path/to/project/src/client/index.js" %}

```javascript
import "react";
```

{% endsamplefile %}
{% endsample %}

åœ¨ä¸Šé¢çš„ç¤ºä¾‹ä¸­ï¼Œ`react`å¯èƒ½ä¼šè§£æžä¸º`/path/to/project/node_modules/react/index.js`ã€‚ç¡®åˆ‡çš„ä½ç½®å°†å–å†³äºŽ`node_modules`ç›®å½•çš„ä½ç½®ä»¥åŠåŒ…å†…çš„é…ç½®ã€‚

`node_modules`ä»Žå¯¼å…¥æ–‡ä»¶å‘ä¸Šæœç´¢ç›®å½•ã€‚æœç´¢åœ¨é¡¹ç›®æ ¹ç›®å½•å¤„åœæ­¢ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœå¯¼å…¥æ–‡ä»¶ä½äºŽ`/path/to/project/src/client/index.js`ä»¥ä¸‹ä½ç½®ï¼Œåˆ™å°†è¢«æœç´¢ï¼š

- `/path/to/project/src/client/node_modules/react`
- `/path/to/project/src/node_modules/react`
- `/path/to/project/node_modules/react`

ä¸€æ—¦æ‰¾åˆ°æ¨¡å—ç›®å½•ï¼Œå°±è§£æžäº†åŒ…æ¡ç›®ã€‚æœ‰å…³æ­¤è¿‡ç¨‹çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[Package entries](#package-entries)ã€‚

#### å­è·¯å¾„åŒ…

è£¸è¯´æ˜Žç¬¦ä¹Ÿå¯ä»¥æŒ‡å®šåŒ…å†…çš„å­è·¯å¾„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªåŒ…å¯èƒ½ä¼šå‘å¸ƒå¤šä¸ªå…¥å£ç‚¹ï¼Œè€Œä¸ä»…ä»…æ˜¯ä¸€ä¸ªå…¥å£ç‚¹ã€‚

```javascript
import "lodash/clone";
```

ä¸Šé¢çš„ç¤ºä¾‹`lodash`åœ¨å¦‚ä¸Šæ‰€è¿°çš„`node_modules`ç›®å½•ä¸­è§£æžï¼Œç„¶åŽ`clone`åœ¨åŒ…ä¸­è§£æžæ¨¡å—è€Œä¸æ˜¯å…¶ä¸»å…¥å£ç‚¹ã€‚ä¾‹å¦‚ï¼Œè¿™å¯èƒ½æ˜¯ä¸€ä¸ª`node_modules/lodash/clone.js`æ–‡ä»¶ã€‚

#### å†…ç½®æ¨¡å—

Parcel åŒ…æ‹¬è®¸å¤šå†…ç½® Node.js æ¨¡å—çš„åž«ç‰‡ï¼Œä¾‹å¦‚`path`å’Œ`url`ã€‚å½“ä¾èµ–è¯´æ˜Žç¬¦å¼•ç”¨è¿™äº›æ¨¡å—åç§°ä¹‹ä¸€æ—¶ï¼Œå†…ç½®æ¨¡å—ä¼˜å…ˆäºŽä»»ä½•å®‰è£…çš„`node_modules` å…·æœ‰ç›¸åŒåç§°çš„æ¨¡å—ã€‚åœ¨ä¸ºèŠ‚ç‚¹çŽ¯å¢ƒæž„å»ºæ—¶ï¼Œå†…ç½®æ¨¡å—ä¼šä»ŽåŒ…ä¸­æŽ’é™¤ï¼Œå¦åˆ™ä¼šåŒ…å«ä¸€ä¸ª shimã€‚æœ‰å…³å†…ç½®æ¨¡å—çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜…[Node docs](https://nodejs.org/dist/latest-v16.x/docs/api/)æ–‡æ¡£ã€‚

åœ¨ä¸º Electron çŽ¯å¢ƒæž„å»ºæ—¶ï¼Œè¯¥`electron`æ¨¡å—ä¹Ÿè¢«è§†ä¸ºå†…ç½®æ¨¡å—å¹¶ä»ŽåŒ…ä¸­æŽ’é™¤ã€‚

### ç»å¯¹è·¯å¾„

ç»å¯¹è·¯å¾„ä»¥`/`å¼€å¤´, å¹¶è§£æžç›¸å¯¹äºŽé¡¹ç›®æ ¹ç›®å½•çš„æ–‡ä»¶ã€‚é¡¹ç›®æ ¹ç›®å½•æ˜¯é¡¹ç›®çš„åŸºæœ¬ç›®å½•ï¼Œé€šå¸¸åŒ…å«åŒ…ç®¡ç†å™¨é”å®šæ–‡ä»¶ï¼ˆä¾‹å¦‚`yarn.lock`æˆ–`package-lock.json`ï¼‰æˆ–æºä»£ç æŽ§åˆ¶ç›®å½•ï¼ˆä¾‹å¦‚`.git`ï¼‰ã€‚ç»å¯¹è¯´æ˜Žç¬¦å¯¹äºŽé¿å…æ·±åº¦åµŒå¥—å±‚æ¬¡ç»“æž„ä¸­éžå¸¸é•¿çš„ç›¸å¯¹è·¯å¾„å¯èƒ½å¾ˆæœ‰ç”¨ã€‚

```javascript
import "/src/client.js";
```

ä¸Šé¢çš„ç¤ºä¾‹å¯ä»¥æ”¾åœ¨é¡¹ç›®ç›®å½•ç»“æž„ä¸­çš„ä»»ä½•ä½ç½®çš„ä»»ä½•æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å§‹ç»ˆè§£æž`/path/to/project/src/client.js`ã€‚

### æ³¢æµªç¬¦è¯´æ˜Žç¬¦

æ³¢æµªç¬¦è¯´æ˜Žç¬¦ä»¥`~`å¼€å¤´ï¼Œå¹¶ç›¸å¯¹äºŽå¯¼å…¥æ–‡ä»¶ä¸­æœ€è¿‘çš„é¡¹ç›®æ ¹ç›®å½•è¿›è¡Œè§£æžã€‚é¡¹ç›®æ ¹ç›®å½•æ˜¯ä¸€ä¸ªåŒ…å«æ–‡ä»¶`package.json`çš„ç›®å½•ï¼Œé€šå¸¸å¯ä»¥åœ¨æ”¹ç›®å½•ä¸­æ‰¾åˆ°`node_modules`ï¼Œæ³¢æµªç¬¦è¯´æ˜Žç¬¦å¯ç”¨äºŽä¸Žç»å¯¹è¯´æ˜Žç¬¦ç±»ä¼¼çš„ç›®çš„ï¼Œä½†å½“æ‚¨æ‹¥æœ‰å¤šä¸ªåŒ…æ—¶æ›´æœ‰ç”¨ã€‚

{% sample %}
{% samplefile "/path/to/project/packages/frontend/src/client/index.js" %}

```javascript
import "~/src/utils.js";
```

{% endsamplefile %}
{% endsample %}

ä¸Šé¢çš„ç¤ºä¾‹å°†è§£æžä¸º`/path/to/project/packages/frontend/src/utils.js`ã€‚

### æŸ¥è¯¢å‚æ•°

ä¾èµ–è¯´æ˜Žç¬¦è¿˜å¯ä»¥åŒ…æ‹¬æŸ¥è¯¢å‚æ•°ï¼Œè¿™äº›å‚æ•°æŒ‡å®šè§£æžæ–‡ä»¶çš„è½¬æ¢é€‰é¡¹ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥æŒ‡å®šå®½åº¦å’Œé«˜åº¦ä»¥åœ¨åŠ è½½å›¾åƒæ—¶è°ƒæ•´å›¾åƒå¤§å°ã€‚

```css
.logo {
  background: url(logo.png?width=400&height=400);
}
```

æœ‰å…³å›¾åƒçš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[Image transformer](/recipes/image/)å›¾ç‰‡è½¬æ¢å™¨æ–‡æ¡£ã€‚æ‚¨è¿˜å¯ä»¥åœ¨è‡ªå®šä¹‰[Transformer](/plugin-system/transformer/)æ’ä»¶ä¸­ä½¿ç”¨æŸ¥è¯¢å‚æ•°ã€‚

{% note %}

**æ³¨æ„**: CommonJS è¯´æ˜Žç¬¦ï¼ˆç”±`require`å‡½æ•°åˆ›å»ºï¼‰ä¸æ”¯æŒæŸ¥è¯¢å‚æ•°ã€‚

{% endnote %}

### URL æ–¹æ¡ˆ

ä¾èµ–è¯´æ˜Žç¬¦å¯ä»¥ä½¿ç”¨ URL æ–¹æ¡ˆæ¥å®šä½[Named pipelines](/features/plugins/#named-pipelines)ã€‚è¿™äº›å…è®¸æ‚¨æŒ‡å®šä¸åŒçš„ç®¡é“æ¥ç¼–è¯‘æ–‡ä»¶ï¼Œè€Œä¸æ˜¯é»˜è®¤ç®¡é“ã€‚ä¾‹å¦‚ï¼Œè¯¥`bundle-text:`æ–¹æ¡ˆå¯ç”¨äºŽå°†å·²ç¼–è¯‘çš„æ†ç»‘åŒ…å†…è”ä¸ºæ–‡æœ¬ã€‚æœ‰å…³æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[Bundle inlining](/features/bundle-inlining/)ã€‚

æœ‰ä¸€äº›ä¿ç•™çš„ URL æ–¹æ¡ˆå¯èƒ½ä¸ä¼šç”¨äºŽå‘½åç®¡é“ï¼Œå¹¶ä¸”å…·æœ‰å†…ç½®è¡Œä¸ºã€‚

- `node:` â€“ æŒ‡å®šå†…ç½®èŠ‚ç‚¹æ¨¡å—çš„å¦ä¸€ç§æ–¹æ³•ã€‚è¯·å‚é˜…[Builtin modules](#builtin-modules)ã€‚
- `npm:` â€“ URL ä¾èµ–é¡¹ï¼ˆä¾‹å¦‚åœ¨ HTMLã€CSS æˆ–ç½‘ç»œå·¥ä½œè€…ä¸­ï¼‰ä»Ž`node_modules`åŒ…ä¸­å¯¼å…¥æ–‡ä»¶çš„ä¸€ç§æ–¹å¼ã€‚
- `http:`å’Œ`https:` â€“ å®Œå…¨é™å®šçš„ URL ä¾èµ–é¡¹ã€‚è¿™äº›åœ¨è¿è¡Œæ—¶è§£å†³ï¼Œå¹¶ä¸”ä¸è¢« Parcel å¤„ç†ã€‚
- `data:` â€“ åŒ…å«å†…è”ä¾èµ–æºä»£ç çš„[æ•°æ® data URL](https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/Data_URIs)ç›®å‰å°šæœªç”± Parcel å®žæ–½ï¼Œä½†ä¿ç•™ä¾›å°†æ¥ä½¿ç”¨ã€‚
- `file:` â€“ [æ–‡ä»¶ file URL](https://datatracker.ietf.org/doc/html/rfc8089)ã€‚ä¿ç•™ä¾›å°†æ¥ä½¿ç”¨ã€‚
- `mailto:`å’Œ`tel:` - å¸¸ç”¨çš„ URL æ–¹æ¡ˆã€‚è¿™äº›éƒ½æ²¡æœ‰è¢« parcel æ‰€è§¦åŠã€‚

### å…¨å±€è¯´æ˜Žç¬¦

Parcel æ”¯æŒé€šè¿‡ glob ä¸€æ¬¡å¯¼å…¥å¤šä¸ªæ–‡ä»¶ï¼Œä½†æ˜¯ï¼Œç”±äºŽ glob å¯¼å…¥æ˜¯éžæ ‡å‡†çš„ï¼Œå› æ­¤å®ƒä»¬ä¸åŒ…å«åœ¨é»˜è®¤ Parcel é…ç½®ä¸­ã€‚è¦å¯ç”¨å®ƒä»¬ï¼Œè¯·æ·»åŠ `@parcel/resolver-glob`åˆ°æ‚¨çš„`.parcelrc`ã€‚

{% sample %}
{% samplefile ".parcelrc" %}

```json
{
  "extends": "@parcel/config-default",
  "resolvers": ["@parcel/resolver-glob", "..."]
}
```

{% endsamplefile %}
{% endsample %}

å¯ç”¨åŽï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¸å¦‚`./files/*.js`ã€‚è¿™å°†è¿”å›žä¸€ä¸ªå¯¹è±¡ï¼Œå…¶é”®å¯¹åº”äºŽæ–‡ä»¶åã€‚

```javascript
import * as files from "./files/*.js";
```

ç›¸å½“äºŽï¼š

```javascript
import * as foo from "./files/foo.js";
import * as bar from "./files/bar.js";

let files = {
  foo,
  bar,
};
```

å…·ä½“æ¥è¯´ï¼Œglob æ¨¡å¼çš„åŠ¨æ€éƒ¨åˆ†æˆä¸ºå¯¹è±¡çš„é”®ã€‚å¦‚æžœæœ‰å¤šä¸ªåŠ¨æ€éƒ¨åˆ†ï¼Œå°†è¿”å›žä¸€ä¸ªåµŒå¥—å¯¹è±¡ã€‚ä¾‹å¦‚ï¼Œå¦‚æžœ`pages/profile/index.js`æ–‡ä»¶å­˜åœ¨ï¼Œåˆ™ä»¥ä¸‹å†…å®¹å°†åŒ¹é…å®ƒã€‚

```javascript
import * as pages from "./pages/*/*.js";

console.log(pages.profile.index);
```

è¿™ä¹Ÿé€‚ç”¨äºŽ URL æ–¹æ¡ˆ`bundle-text:`ï¼Œå¦‚ ï¼Œä»¥åŠåŠ¨æ€å¯¼å…¥ã€‚ä½¿ç”¨åŠ¨æ€å¯¼å…¥æ—¶ï¼Œç”Ÿæˆçš„å¯¹è±¡å°†åŒ…æ‹¬æ–‡ä»¶ååˆ°å‡½æ•°çš„æ˜ å°„ã€‚å¯ä»¥è°ƒç”¨æ¯ä¸ªå‡½æ•°æ¥åŠ è½½å·²è§£æžçš„æ¨¡å—ã€‚è¿™æ„å‘³ç€æ¯ä¸ªæ–‡ä»¶éƒ½æ˜¯æŒ‰éœ€åŠ è½½çš„ï¼Œè€Œä¸æ˜¯å…¨éƒ¨é¢„å…ˆåŠ è½½çš„ã€‚

```javascript
let files = import("./files/*.js");

async function doSomething() {
  let foo = await files.foo();
  let bar = await files.bar();
  return foo + bar;
}
```

Globs ä¹Ÿå¯ç”¨äºŽä»Ž npm åŒ…ä¸­å¯¼å…¥æ–‡ä»¶ï¼š

```js
import * as locales from "@company/pkg/i18n/*.js";

console.log(locales.en.message);
```

Glob å¯¼å…¥ä¹Ÿé€‚ç”¨äºŽ CSSï¼š

```css
@import "./components/*.css";
```

ç›¸å½“äºŽï¼š

```css
@import "./components/button.css";
@import "./components/dropdown.css";
```

## åŒ…ç›®å½•

è§£æžåŒ…ç›®å½•æ—¶ï¼Œ`package.json`ä¼šæŸ¥é˜…è¯¥æ–‡ä»¶ä»¥ç¡®å®šåŒ…æ¡ç›®ã€‚Parcel æ£€æŸ¥ä»¥ä¸‹å­—æ®µï¼ˆæŒ‰é¡ºåºï¼‰ï¼š

- `source` â€“ å¦‚æžœæ¨¡å—ä½äºŽç¬¦å·é“¾æŽ¥åŽé¢ï¼ˆä¾‹å¦‚åœ¨ monorepo æˆ– via ä¸­`npm link`ï¼‰ï¼Œåˆ™ Parcel ä½¿ç”¨è¯¥`source`å­—æ®µä»Žæºä»£ç ç¼–è¯‘æ¨¡å—ã€‚å¦‚æžœåŒ…æœ‰å¤šä¸ªå…¥å£ç‚¹ï¼Œè¯¥`source`å­—æ®µä¹Ÿå¯ä»¥ç”¨ä½œåˆ«åæ˜ å°„ - æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„[Aliases](#aliases)ã€‚
- `browser` â€“ ç‰¹å®šäºŽæµè§ˆå™¨çš„åŒ…ç‰ˆæœ¬ã€‚å¦‚æžœä¸º[æµè§ˆå™¨çŽ¯å¢ƒï¼ˆbrowser environmentï¼‰](/features/targets/#environments)æž„å»ºï¼Œæµè§ˆå™¨å­—æ®µä¼šè¦†ç›–å…¶ä»–å­—æ®µã€‚å¦‚æžœåŒ…æœ‰å¤šä¸ªå…¥å£ç‚¹ï¼Œè¯¥`browser`å­—æ®µä¹Ÿå¯ä»¥ç”¨ä½œåˆ«åæ˜ å°„ - æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸‹é¢çš„[Aliases](#aliases)ã€‚
- `module` â€“ åŒ…çš„ ES æ¨¡å—ç‰ˆæœ¬ã€‚
- `main` â€“ åŒ…çš„ CommonJS ç‰ˆæœ¬ã€‚

å¦‚æžœè¿™äº›å­—æ®µå‡æœªè®¾ç½®ï¼Œæˆ–è€…å®ƒä»¬æŒ‡å‘çš„æ–‡ä»¶ä¸å­˜åœ¨ï¼Œåˆ™è§£æžå›žé€€åˆ°ç´¢å¼•æ–‡ä»¶ã€‚æœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…[ç›®å½•ç´¢å¼•æ–‡ä»¶ï¼ˆDirectory index filesï¼‰](#directory-index-files)ã€‚

## åˆ«å Aliases

åˆ«åå¯ç”¨äºŽè¦†ç›–ä¾èµ–é¡¹çš„æ­£å¸¸è§£æžã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½å¸Œæœ›ä½¿ç”¨ä¸åŒä½†ä¸Ž API å…¼å®¹çš„æ›¿æ¢æ¥è¦†ç›–æ¨¡å—ï¼Œæˆ–è€…å°†ä¾èµ–é¡¹æ˜ å°„åˆ°ç”±ä»Ž CDN åŠ è½½çš„åº“å®šä¹‰çš„å…¨å±€å˜é‡ã€‚

åˆ«åæ˜¯é€šè¿‡ package.json ä¸­çš„`alias`å®šä¹‰çš„ã€‚å®ƒä»¬å¯ä»¥åœ¨æœ€æŽ¥è¿‘`package.json`åŒ…å«ä¾èµ–é¡¹çš„æºæ–‡ä»¶ä¸­æœ¬åœ°å®šä¹‰ï¼Œä¹Ÿå¯ä»¥`package.json`åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸­å…¨å±€å®šä¹‰ã€‚å…¨å±€åˆ«åé€‚ç”¨äºŽé¡¹ç›®ä¸­çš„æ‰€æœ‰æ–‡ä»¶å’ŒåŒ…ï¼ŒåŒ…æ‹¬`node_modules`ã€‚

### åŒ…åˆ«å

åŒ…åˆ«åå°†`node_modules`ä¾èµ–é¡¹æ˜ å°„åˆ°ä¸åŒçš„åŒ…æˆ–é¡¹ç›®ä¸­çš„æœ¬åœ°æ–‡ä»¶ã€‚ä¾‹å¦‚ï¼Œè¦åœ¨é¡¹ç›®ä¸­å°†`react`å’Œ`react-dom` æ›¿æ¢ä¸º Preact æ‚¨å¯ä»¥åœ¨é¡¹ç›®æ ¹ç›®å½•`package.json`ä¸­å®šä¹‰å…¨å±€åˆ«åã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "alias": {
    "react": "preact/compat",
    "react-dom": "preact/compat"
  }
}
```

{% endsamplefile %}
{% endsample %}

æ‚¨è¿˜å¯ä»¥ä½¿ç”¨å®šä¹‰åˆ«åçš„ç›¸å¯¹è·¯å¾„å°†æ¨¡å—æ˜ å°„åˆ°é¡¹ç›®ä¸­çš„`package.json`æ–‡ä»¶ã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "alias": {
    "react": "./my-react.js"
  }
}
```

{% endsamplefile %}
{% endsample %}

ä¹Ÿæ”¯æŒä»…å¯¹æ¨¡å—çš„æŸäº›[å­è·¯å¾„ sub-paths](#package-sub-paths)è¿›è¡Œåˆ«åã€‚æ­¤ç¤ºä¾‹å°†åˆ«å`lodash/clone`ä¸º`tiny-clone`ã€‚`lodash`åŒ…ä¸­çš„å…¶ä»–å¯¼å…¥å°†ä¸å—å½±å“ã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "alias": {
    "lodash/clone": "tiny-clone"
  }
}
```

{% endsamplefile %}
{% endsample %}

è¿™ä¹Ÿé€‚ç”¨äºŽå¦ä¸€ç§æ–¹å¼ï¼šå¦‚æžœæ•´ä¸ªæ¨¡å—æœ‰åˆ«åï¼Œåˆ™è¯¥åŒ…çš„ä»»ä½•å­è·¯å¾„å¯¼å…¥éƒ½å°†åœ¨åˆ«åæ¨¡å—ä¸­è§£æžã€‚ä¾‹å¦‚ï¼Œå¦‚æžœæ‚¨ä½¿ç”¨åˆ«åå°†`lodash`ä¸º`my-lodash`ï¼Œå¹¶ä¸”å¯¼å…¥`lodash/clone`ï¼Œè¿™å°†è§£æžä¸º`my-lodash/clone`ã€‚

### æ–‡ä»¶åˆ«å

åˆ«åä¹Ÿå¯ä»¥å®šä¹‰ä¸ºç›¸å¯¹è·¯å¾„ï¼Œä»¥ç”¨ä¸åŒçš„æ–‡ä»¶æ›¿æ¢åŒ…ä¸­çš„ç‰¹å®šæ–‡ä»¶ã€‚è¿™å¯ä»¥ä½¿ç”¨`alias`å­—æ®µæ¥æ— æ¡ä»¶åœ°æ›¿æ¢æ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨`source`æˆ–`browser`å­—æ®µæ¥æœ‰æ¡ä»¶åœ°å®Œæˆã€‚æœ‰å…³è¿™äº›å­—æ®µçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸Šé¢[åŒ…ç›®å½•](#package-entries)ã€‚

ä¾‹å¦‚ï¼Œè¦å°†æŸä¸ªæ–‡ä»¶æ›¿æ¢ä¸ºç‰¹å®šäºŽæµè§ˆå™¨çš„ç‰ˆæœ¬ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨è¯¥`browser`å­—æ®µã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "browser": {
    "./fs.js": "./fs-browser.js"
  }
}
```

{% endsamplefile %}
{% endsample %}

çŽ°åœ¨ï¼Œå¦‚æžœ`my-module/fs.js`åœ¨æµè§ˆå™¨çŽ¯å¢ƒä¸­å¯¼å…¥ï¼Œå®ƒä»¬å®žé™…ä¸Šä¼šå¾—åˆ°`my-module/fs-browser.js`. è¿™æ—¢é€‚ç”¨äºŽä»Žå¤–éƒ¨ï¼ˆä¾‹å¦‚[å­è·¯å¾„ package sub-paths](#package-sub-paths)ï¼‰çš„å¯¼å…¥ï¼Œä¹Ÿé€‚ç”¨äºŽæ¨¡å—å†…éƒ¨çš„å¯¼å…¥ã€‚

### å…¨å±€åˆ«å

æ–‡ä»¶åˆ«åä¹Ÿå¯ä»¥ä½¿ç”¨ glob å®šä¹‰ï¼Œå®ƒå…è®¸ä½¿ç”¨å•ä¸ªæ¨¡å¼æ›¿æ¢è®¸å¤šæ–‡ä»¶ã€‚æ›¿æ¢å¯ä»¥åŒ…æ‹¬è¯¸å¦‚`$1`è®¿é—®æ•èŽ·çš„å…¨å±€åŒ¹é…çš„æ¨¡å¼ã€‚è¿™å¯ä»¥ä½¿ç”¨`alias`å­—æ®µæ¥æ— æ¡ä»¶åœ°æ›¿æ¢æ–‡ä»¶ï¼Œæˆ–è€…ä½¿ç”¨`source`æˆ–`browser`å­—æ®µæ¥æœ‰æ¡ä»¶åœ°å®Œæˆã€‚æœ‰å…³è¿™äº›å­—æ®µçš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…ä¸Šé¢çš„[åŒ…ç›®å½• Package entries](#package-entries)ã€‚

ä¾‹å¦‚ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨`source`å­—æ®µæ¥æä¾›åŒ…ä¸­å·²ç¼–è¯‘ä»£ç ä¸ŽåŽŸå§‹æºä»£ç ä¹‹é—´çš„æ˜ å°„ã€‚å½“æ¨¡å—è¢«ç¬¦å·é“¾æŽ¥æ—¶ï¼Œæˆ–è€…åœ¨ monorepo ä¸­ï¼Œè¿™å°†å…è®¸ Parcel ä»Žæºä»£ç ç¼–è¯‘æ¨¡å—ï¼Œè€Œä¸æ˜¯ä½¿ç”¨é¢„ç¼–è¯‘ç‰ˆæœ¬ã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "source": {
    "./dist/*": "./src/$1"
  }
}
```

{% endsamplefile %}
{% endsample %}

çŽ°åœ¨ï¼Œæ¯æ¬¡å¯¼å…¥ç›®å½•ä¸­çš„`src`æ–‡ä»¶æ—¶ï¼Œéƒ½ä¼šåŠ è½½æ–‡ä»¶å¤¹ dist ä¸­çš„ç›¸åº”æ–‡ä»¶ã€‚

### åž«ç‰‡åˆ«å

æ–‡ä»¶æˆ–åŒ…å¯ä»¥åˆ«åä¸º`false`ä»Žæž„å»ºä¸­æŽ’é™¤ï¼Œå¹¶æ›¿æ¢ä¸ºç©ºæ¨¡å—ã€‚ä¾‹å¦‚ï¼Œè¿™å¯¹äºŽä»Žä»…åœ¨ Node.js ä¸­å·¥ä½œçš„æµè§ˆå™¨æž„å»ºä¸­æŽ’é™¤æŸäº›æ¨¡å—å¯èƒ½å¾ˆæœ‰ç”¨ã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "alias": {
    "fs": false
  }
}
```

{% endsamplefile %}
{% endsample %}

### å…¨å±€åˆ«å

æ–‡ä»¶æˆ–åŒ…ä¹Ÿå¯ä»¥åˆ«åä¸ºå°†åœ¨è¿è¡Œæ—¶å®šä¹‰çš„å…¨å±€å˜é‡ã€‚ä¾‹å¦‚ï¼Œå¯ä»¥ä»Ž CDN åŠ è½½ç‰¹å®šåº“ã€‚è€Œä¸æ˜¯æ†ç»‘å®ƒï¼Œåªè¦è§£å†³äº†å¯¹è¯¥åº“çš„ä¾èµ–å…³ç³»ï¼Œå®ƒå°†è¢«æ›¿æ¢ä¸ºå¯¹è¯¥å…¨å±€å˜é‡çš„å¼•ç”¨ï¼Œè€Œä¸æ˜¯è¢«æ†ç»‘ã€‚

è¿™å¯ä»¥é€šè¿‡ä¸ºå…·æœ‰`global`å±žæ€§çš„å¯¹è±¡åˆ›å»ºåˆ«åæ¥å®Œæˆã€‚ä»¥ä¸‹ç¤ºä¾‹å°†`jquery`ä¾èµ–è¯´æ˜Žç¬¦åˆ«åä¸ºå…¨å±€å˜é‡`$`ã€‚

{% sample %}
{% samplefile "package.json" %}

```json
{
  "alias": {
    "jquery": {
      "global": "$"
    }
  }
}
```

{% endsamplefile %}
{% endsample %}

## é…ç½®å…¶ä»–å·¥å…·

æœ¬èŠ‚ä»‹ç»å¦‚ä½•é…ç½®å…¶ä»–å·¥å…·ä»¥ä½¿ç”¨ Parcel å¯¹èŠ‚ç‚¹è§£æžç®—æ³•çš„æ‰©å±•ã€‚

### TypeScript

éœ€è¦å°† TypeScript é…ç½®ä¸ºæ”¯æŒ Parcel åŠŸèƒ½ï¼Œä¾‹å¦‚ç»å¯¹å’Œæ³¢æµªå·ä¾èµ–è¯´æ˜Žç¬¦ä»¥åŠåˆ«åã€‚è¿™å¯ä»¥ä½¿ç”¨ ä¸­çš„`paths`é€‰é¡¹æ¥å®Œæˆ`tsconfig.json`ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…[TypeScript æ¨¡å—è§£æž](https://www.typescriptlang.org/docs/handbook/module-resolution.html)æ–‡æ¡£ã€‚

ä¾‹å¦‚ï¼Œè¦å°†æ³¢æµªå·è·¯å¾„æ˜ å°„åˆ°æ ¹ç›®å½•ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹é…ç½®ï¼š

{% sample %}
{% samplefile "tsconfig.json" %}

```json
{
  "compilerOptions": {
    "baseUrl": ".",
    "paths": {
      "~*": ["./*"]
    }
  }
}
```

{% endsamplefile %}
{% endsample %}

å¯ç”¨å¯¹[URL schemes](#url-schemes)çš„æ”¯æŒï¼Œå¯ä»¥é€šè¿‡åœ¨é¡¹ç›®ä¸­åˆ›å»º[ambient module](https://www.typescriptlang.org/docs/handbook/modules.html#ambient-modules) ä¾‹å¦‚ï¼Œè¦å°†éšæ–¹æ¡ˆåŠ è½½çš„ä¾èµ–é¡¹æ˜ å°„åˆ°å­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å£°æ˜Žã€‚è¿™å¯ä»¥æ”¾ç½®åœ¨æ–‡ä»¶`parcel.d.ts`ä¸­ï¼Œä¾‹å¦‚é¡¹ç›®ä¸­çš„ä»»ä½•ä½ç½®ã€‚

{% sample %}
{% samplefile "parcel.d.ts" %}

```typescript
declare module "bundle-text:*" {
  const value: string;
  export default value;
}
```

{% endsamplefile %}
{% endsample %}

### Flow

Flow éœ€è¦é…ç½®ä¸ºæ”¯æŒç»å¯¹å’Œæ³¢æµªç¬¦è¯´æ˜Žç¬¦ä»¥åŠåˆ«åã€‚è¿™å¯ä»¥ä½¿ç”¨æ‚¨[module.name_mapper](https://flow.org/en/docs/config/options/#toc-module-name-mapper-regex-string)çš„`.flowconfig`.

ä¾‹å¦‚ï¼Œè¦æ˜ å°„ç»å¯¹è¯´æ˜Žç¬¦ä»¥ä»Žé¡¹ç›®æ ¹ç›®å½•è§£æžï¼Œå¯ä»¥ä½¿ç”¨æ­¤é…ç½®ï¼š

{% sample %}
{% samplefile ".flowconfig" %}

```
[options]
module.name_mapper='^\/\(.*\)$' -> '<PROJECT_ROOT>/\1'
```

{% endsamplefile %}
{% endsample %}

è¦å¯ç”¨[url æ–¹æ¡ˆ URL schemes](#url-schemes)æ‚¨éœ€è¦åˆ›å»ºåˆ°å¯¼å‡ºé¢„æœŸç±»åž‹çš„`.flow`[æè¿°æ–‡ä»¶ declaration file](https://flow.org/en/docs/declarations/)ã€‚ä¾‹å¦‚ï¼Œè¦å°†éš`bundle-text:`æ–¹æ¡ˆåŠ è½½çš„ä¾èµ–é¡¹æ˜ å°„åˆ°å­—ç¬¦ä¸²ï¼Œæ‚¨å¯ä»¥åˆ›å»ºä¸€ä¸ªåä¸ºçš„æ–‡ä»¶`bundle-text.js.flow`ï¼Œå¹¶å°†å¼•ç”¨è¯¥æ–¹æ¡ˆçš„æ‰€æœ‰ä¾èµ–é¡¹æ˜ å°„åˆ°å®ƒã€‚

{% sample %}
{% samplefile "bundle-text.js.flow" %}

```javascript
// @flow
declare var value: string;
export default value;
```

{% endsamplefile %}
{% samplefile ".flowconfig" %}

```
[options]
module.name_mapper='^bundle-text:.*$' -> '<PROJECT_ROOT>/bundle-text.js'
```

{% endsamplefile %}
{% endsample %}
